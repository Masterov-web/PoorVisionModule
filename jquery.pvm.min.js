!function(t){t.fn.pvm=function(o){t(window).load(function(){function e(o){function e(){var t=document.cookie.match(/PVM_[^=]+/g);if(!t)return!1;var o,e,n;for(n=0;n<t.length;n++)o=r(P(t[n])),e=m[t[n]][o[0]],o[1]!=e&&u(t[n],e);return!0}if(o&&o.preventDefault(),P("PVMactivate")||u("PVMactivate","true"),e()||(u("PVM_fontSize",m.PVM_fontSize.big),u("PVM_backgroundColor",m.PVM_backgroundColor.theme1),u("PVM_color",m.PVM_color.theme1),u("PVM_borderColor",m.PVM_borderColor.theme1),u("PVM_letterSpacing",m.PVM_letterSpacing.ls1),u("PVM_fontFamily",m.PVM_fontFamily.sans)),t("#pvm").children().length)return b.addClass("pvm-activate"),d.addClass("hide-origView"),void console.log("PVM activate");for(_.children().wrapAll('<div id="origView"></div>'),d=t("#origView"),b=d.find("#pvm");b.next().length;)_.append(b.next());b.insertAfter(d),b.append('<div id="PVM_wrapper"><div class="PVM-wrapper-toolbar" id="PVM_toolbar"><div class="PVM-toolbar"><div class="PVM-toolbar-items"><div id="PVM_fontSizeItem" class="PVM-toolbar-item"><h2>Размер шрифта</h2><ul><li><button class="PVM-toolbar-button PVM-button-big"><span>A</span></button></li><li><button class="PVM-toolbar-button PVM-button-bigger"><span>A</span></button></li><li><button class="PVM-toolbar-button PVM-button-biggest"><span>A</span></button></li></ul></div><div id="PVM_colorSchemeItem" class="PVM-toolbar-item"><h2>Выбор цвета</h2><ul><li><button class="PVM-toolbar-button PVM-button-theme1"><span>Aa</span></button></li><li><button class="PVM-toolbar-button PVM-button-theme2"><span>Aa</span></button></li><li><button class="PVM-toolbar-button PVM-button-theme3"><span>Aa</span></button></li></ul></div><div id="PVM_letterSpacingItem" class="PVM-toolbar-item"><h2>Межбуквенный интервал</h2><ul><li><button class="PVM-toolbar-button PVM-button-ls1"><span>Aa</span></button></li><li><button class="PVM-toolbar-button PVM-button-ls2"><span>Aa</span></button></li><li><button class="PVM-toolbar-button PVM-button-ls3"><span>Aa</span></button></li></ul></div><div id="PVM_serifItem" class="PVM-toolbar-item"><h2>Тип шрифта</h2><ul><li><button class="PVM-toolbar-button PVM-button-sans"><span>Aa</span></button></li><li><button class="PVM-toolbar-button PVM-button-serif"><span>Aa</span></button></li></ul></div></div><button class="PVM-toolbar-button PVM-normal-view" id="PVM_normalView">Стандартный режим</button></div></div><button class="PVM-toggle-toolbar PVM-close-toolbar">Закрыть панель</button></div>');var M=(t("#PVM_wrapper"),t("#PVM_toolbar"));d.contents().clone().appendTo(t("#PVM_wrapper")),b.addClass("pvm-activate"),d.addClass("hide-origView");var f=t(".PVM-toggle-toolbar");f.on("click",function(){t(this).hasClass("PVM-close-toolbar")?(t(this).text("Открыть панель"),t(this).removeClass("PVM-close-toolbar").addClass("PVM-open-toolbar")):(t(this).text("Закрыть панель"),t(this).removeClass("PVM-open-toolbar").addClass("PVM-close-toolbar")),M.slideToggle()}),b.css({"font-size":+r(P("PVM_fontSize"))[1],"background-color":r(P("PVM_backgroundColor"))[1],color:r(P("PVM_color"))[1],"border-color":r(P("PVM_borderColor"))[1],"letter-spacing":+r(P("PVM_letterSpacing"))[1],"font-family":r(P("PVM_fontFamily"))[1]}),b.children().each(function(){c(this,g),V(this)}),b.find(t(".PVM-open-button")).remove();var p=t("#PVM_normalView");p.on("click",function(){b.removeClass("pvm-activate"),d.removeClass("hide-origView"),h("PVMactivate"),console.log("PVM deactivate")});var v=t("#PVM_fontSizeItem");i(m.PVM_fontSize,"PVM_fontSize"),v.on("click","button",function(){v.find("button").each(function(){t(this).removeClass("PVM-active-button")}),t(this).addClass("PVM-active-button"),t(this).hasClass("PVM-button-big")?(b.css({"font-size":+r(m.PVM_fontSize.big)[1]}),u("PVM_fontSize",m.PVM_fontSize.big)):t(this).hasClass("PVM-button-bigger")?(b.css({"font-size":+r(m.PVM_fontSize.bigger)[1]}),u("PVM_fontSize",m.PVM_fontSize.bigger)):t(this).hasClass("PVM-button-biggest")&&(b.css({"font-size":+r(m.PVM_fontSize.biggest)[1]}),u("PVM_fontSize",m.PVM_fontSize.biggest))});var C=t("#PVM_colorSchemeItem");l(C),i(m.PVM_backgroundColor,"PVM_backgroundColor"),C.on("click","button",function(){C.find("button").each(function(){t(this).removeClass("PVM-active-button")}),t(this).addClass("PVM-active-button"),t(this).hasClass("PVM-button-theme1")?(b.css({"background-color":r(m.PVM_backgroundColor.theme1)[1],color:r(m.PVM_color.theme1)[1],"border-color":r(m.PVM_borderColor.theme1)[1]}),u("PVM_backgroundColor",m.PVM_backgroundColor.theme1),u("PVM_color",m.PVM_color.theme1),u("PVM_borderColor",m.PVM_borderColor.theme1)):t(this).hasClass("PVM-button-theme2")?(b.css({"background-color":r(m.PVM_backgroundColor.theme2)[1],color:r(m.PVM_color.theme2)[1],"border-color":r(m.PVM_borderColor.theme2)[1]}),u("PVM_backgroundColor",m.PVM_backgroundColor.theme2),u("PVM_color",m.PVM_color.theme2),u("PVM_borderColor",m.PVM_borderColor.theme2)):t(this).hasClass("PVM-button-theme3")&&(b.css({"background-color":r(m.PVM_backgroundColor.theme3)[1],color:r(m.PVM_color.theme3)[1],"border-color":r(m.PVM_borderColor.theme3)[1]}),u("PVM_backgroundColor",m.PVM_backgroundColor.theme3),u("PVM_color",m.PVM_color.theme3),u("PVM_borderColor",m.PVM_borderColor.theme3))});var k=t("#PVM_letterSpacingItem");i(m.PVM_letterSpacing,"PVM_letterSpacing"),k.on("click","button",function(){k.find("button").each(function(){t(this).removeClass("PVM-active-button")}),t(this).addClass("PVM-active-button"),t(this).hasClass("PVM-button-ls1")?(b.css({"letter-spacing":+r(m.PVM_letterSpacing.ls1)[1]}),u("PVM_letterSpacing",m.PVM_letterSpacing.ls1)):t(this).hasClass("PVM-button-ls2")?(b.css({"letter-spacing":+r(m.PVM_letterSpacing.ls2)[1]}),u("PVM_letterSpacing",m.PVM_letterSpacing.ls2)):t(this).hasClass("PVM-button-ls3")&&(b.css({"letter-spacing":+r(m.PVM_letterSpacing.ls3)[1]}),u("PVM_letterSpacing",m.PVM_letterSpacing.ls3))});var S=t("#PVM_serifItem");i(m.PVM_fontFamily,"PVM_fontFamily"),S.on("click","button",function(){S.find("button").each(function(){t(this).removeClass("PVM-active-button")}),t(this).addClass("PVM-active-button"),t(this).hasClass("PVM-button-sans")?(b.css({"font-family":r(m.PVM_fontFamily.sans)[1]}),u("PVM_fontFamily",m.PVM_fontFamily.sans)):t(this).hasClass("PVM-button-serif")&&(b.css({"font-family":r(m.PVM_fontFamily.serif)[1]}),u("PVM_fontFamily",m.PVM_fontFamily.serif))}),b.find("img").hide(),n(),a(s()),console.log("PVM activate")}function n(){var o,e=b.find("a");e.each(function(){t(this).find("img").length&&(o=""==t(this).attr("title")||void 0==t(this).attr("title")?'<span class="PVM-links-text">'+t(this).attr("href")+"</span>":'<span class="PVM-links-text">'+t(this).attr("title")+"</span>",t(this).css({display:"block"}).html(o+t(this).html()))})}function s(){var o=b.find(".PVM-menu");return o.map(function(o){t(this).attr("id","PVM_Menu_0"+o)}),o}function a(o){var e,n;o.each(function(o){function s(t){t.data.ULmenu.slideToggle()}e=t("<div/>",{id:"PVM_wrapperMenu_0"+o,"class":"PVM-wrapper-menu"}),n=t("<button/>",{id:"PVM_menuToogleButton_0"+o,"class":"PVM-menu-toogle-button"}),n.text(t(this).data("menu-name")),t(this).wrap(e),t(this).parent().prepend(n),t("body").on("click","#PVM_menuToogleButton_0"+o,{ULmenu:t(this)},s);var a=t(this).find("li");a.each(function(){if(t(this).has("ul").length){var o=t("<span />",{"class":"PVM-menu-arrow"});o.html("▼"),t(this).children("a").after(o)}}),t(this).on("click",".PVM-menu-arrow",function(){t(this).html("▼"==t(this).html()?"▲":"▼"),t(this).closest("li").children("ul").slideToggle()}),t(this).on("click","a",function(o){o.preventDefault();var e=t(this),n=e.closest("li");n.has("ul").length?"none"==n.children("ul").css("display")?(n.children("ul").slideDown(),e.next().html("▼"==e.next().html()?"▲":"▼")):(n.children("ul").slideUp(),e.next().html("▼"==e.next().html()?"▲":"▼"),window.location.assign(e.attr("href"))):window.location.assign(e.attr("href"))})})}function i(o,e){for(key in o)P(e)==o[key]&&t(".PVM-button-"+key).addClass("PVM-active-button")}function l(o){var e,n=o.find("button");n.each(function(){e=t(this).attr("class").match(/theme\d+/i),t(this).css({"background-color":r(m.PVM_backgroundColor[e[0]])[1],color:r(m.PVM_color[e[0]])[1]})})}function r(t){var o=t.split("__");return o}function c(o,e){var n;for(n=0;n<e.length;n++)t(o).removeAttr(e[n]);t(o).children().length&&t(o).children().each(function(){c(this,e)})}function V(o){if(t(o).attr("class")){var e,n=t(o).attr("class").split(" ");for(e=0;e<n.length;e++)~n[e].indexOf("PVM-")||M(o,n,e)}t(o).attr("id")&&t(o).attr("id").indexOf("PVM_",0)&&t(o).attr("id","PVM_"+t(o).attr("id")),t(o).attr("for")&&t(o).attr("for","PVM_"+t(o).attr("for")),t(o).children().length&&t(o).children().each(function(){V(this)})}function M(o,e,n){if(m.PVM_saveClasses&&m.PVM_saveClasses.singleClass){var s;for(s=m.PVM_saveClasses.singleClass.length-1;s>=0;s--)if(e[n]==m.PVM_saveClasses.singleClass[s])return}if(m.PVM_saveClasses&&m.PVM_saveClasses.groupOfClasses){var a=e[n].match(m.PVM_saveClasses.groupOfClasses);if(a)return}e[n]="PVM-"+e[n],t(o).attr("class",e.join(" "))}function P(t){var o=document.cookie.match(RegExp("(?:^|; )"+t.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return o?decodeURIComponent(o[1]):void 0}function u(t,o,e){o=encodeURIComponent(o);var n=e||new Date(2100,0).toUTCString(),s="path=/",a="expires="+n,i=t+"="+o+"; "+s+"; "+a;document.cookie=i}function h(t){u(t,"",-1)}var b,d,_=t("body"),f=(t("body").contents(),t(".PVM-open-button")),m=t.extend(!0,{PVM_fontSize:{big:"big__18",bigger:"bigger__22",biggest:"biggest__26"},PVM_backgroundColor:{theme1:"theme1__#fff",theme2:"theme2__#000",theme3:"theme3__#ff0"},PVM_color:{theme1:"theme1__#000",theme2:"theme2__#fff",theme3:"theme3__#0ff"},PVM_borderColor:{theme1:"theme1__#000",theme2:"theme2__#fff",theme3:"theme3__#0ff"},PVM_letterSpacing:{ls1:"ls1__0",ls2:"ls2__2",ls3:"ls3__4"},PVM_fontFamily:{sans:"sans__sans-serif",serif:"serif__serif"}},o),g=["style"];P("PVMactivate")&&(e(),t(".pvm-preloader").fadeOut()),f.on("click",e)})}}(jQuery);